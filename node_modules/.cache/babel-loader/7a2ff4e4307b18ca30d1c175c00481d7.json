{"ast":null,"code":"import _slicedToArray from\"/Users/xiuhuiwang/Documents/USF/CS686_CloudComputing/final/mld/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import NavBar from'../components/Navbar/NavBar';import Footer from'../components/Footer';import{useDocTitle}from'../components/CustomHook';import axios from'axios';import Notiflix from'notiflix';import Cookies from'universal-cookie';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UploadAudio=function UploadAudio(){// useDocTitle('MLD | Molad e Konsult - Send us a message')\nuseDocTitle('SpeakTranscribe | Upload your audio file');var _useState=useState([]),_useState2=_slicedToArray(_useState,2),errors=_useState2[0],setErrors=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),audio_file=_useState4[0],setFile=_useState4[1];var clearErrors=function clearErrors(){setErrors([]);};var clearInput=function clearInput(){setFile(null);};var sendFile=function sendFile(e){var cookies=new Cookies();var id_token=cookies.get('id_token');var email=cookies.get('email');var timestamp=new Date().getTime();var UPLOAD_AUDIO_TO_S3_API=\"https://wpfyc71o76.execute-api.us-west-2.amazonaws.com/dev/\";var BUCKET_NAME=\"cs690-transcribe/\";if(!id_token){// pop up a window show message\nvar confirmation=window.confirm(\"You should log in. Press OK to go to the login page.\");// Redirect to login page\nif(confirmation){window.location.href=\"https://xwang.auth.us-west-2.amazoncognito.com/login?client_id=24r2m807jokm1ugg04234bgv09&response_type=token&scope=email+openid+phone&redirect_uri=https%3A%2F%2Fxwang.engineer\";}}e.preventDefault();document.getElementById('submitBtn').disabled=true;document.getElementById('submitBtn').innerHTML='Loading...';var filename=audio_file.name;var fileExtension=filename.split('.').pop().toLowerCase();var content_type='audio/';// .AMR, .FLAC, .M4A, .MP3, .MP4, .OGG, .WAV\nif(fileExtension in['ogg','mp4']){content_type='video/';}content_type+=fileExtension;axios({method:\"put\",url:UPLOAD_AUDIO_TO_S3_API+BUCKET_NAME+email+\"-\"+timestamp+\".\"+fileExtension,// url: \"https://wpfyc71o76.execute-api.us-west-2.amazonaws.com/dev/cs690-transcribe/file1.m4a\",\ndata:audio_file,headers:{'Content-Type':content_type,'Authorization':id_token}}).then(function(response){document.getElementById('submitBtn').disabled=false;document.getElementById('submitBtn').innerHTML='send message';clearInput();//handle success\nNotiflix.Report.success('Success',response.data.message,'Okay');}).catch(function(error){document.getElementById('submitBtn').disabled=false;document.getElementById('submitBtn').innerHTML='send message';//handle error\nvar response=error.response;if(response.status===500){Notiflix.Report.failure('An error occurred',response.data.message,'Okay');}if(response.data.errors!==null){setErrors(response.data.errors);}});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(NavBar,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center mt-8 w-full bg-white py-12 lg:py-24 bg-gray-200\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto my-8 px-4 lg:px-20\",\"data-aos\":\"zoom-in\",children:/*#__PURE__*/_jsx(\"form\",{onSubmit:sendFile,children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full bg-white p-8 my-4 md:px-12 lg:w-9/12 lg:pl-20 lg:pr-40 mr-auto rounded-2xl shadow-2xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"font-bold text-center lg:text-left text-blue-900 uppercase text-4xl\",children:\"UPLOAD YOUR AUDIO\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-4\",children:[/*#__PURE__*/_jsx(\"input\",{name:\"audio_file\",className:\"w-full bg-gray-100 text-gray-900 mt-2 p-3 rounded-lg focus:outline-none focus:shadow-outline\",type:\"file\",placeholder:\"Audio File*\",accept:\".AMR, .FLAC, .M4A, .MP3, .MP4, .OGG, .WAV\",onChange:function onChange(e){return setFile(e.target.files[0]);},onKeyUp:clearErrors}),errors&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm\",children:errors.audio_file})]}),/*#__PURE__*/_jsx(\"div\",{className:\"my-2 w-1/2 lg:w-2/4\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",id:\"submitBtn\",className:\"uppercase text-sm font-bold tracking-wide bg-gray-500 hover:bg-blue-900 text-gray-100 p-3 rounded-lg w-full  focus:outline-none focus:shadow-outline\",children:\"Send File\"})})]})})})}),/*#__PURE__*/_jsx(Footer,{})]});};export default UploadAudio;","map":{"version":3,"sources":["/Users/xiuhuiwang/Documents/USF/CS686_CloudComputing/final/mld/src/pages/UploadAudio.js"],"names":["React","useState","NavBar","Footer","useDocTitle","axios","Notiflix","Cookies","UploadAudio","errors","setErrors","audio_file","setFile","clearErrors","clearInput","sendFile","e","cookies","id_token","get","email","timestamp","Date","getTime","UPLOAD_AUDIO_TO_S3_API","BUCKET_NAME","confirmation","window","confirm","location","href","preventDefault","document","getElementById","disabled","innerHTML","filename","name","fileExtension","split","pop","toLowerCase","content_type","method","url","data","headers","then","response","Report","success","message","catch","error","status","failure","target","files"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport NavBar from '../components/Navbar/NavBar';\nimport Footer from '../components/Footer';\nimport {useDocTitle} from '../components/CustomHook';\nimport axios from 'axios';\nimport Notiflix from 'notiflix';\nimport Cookies from 'universal-cookie';\n\n\nconst UploadAudio = () => {\n    // useDocTitle('MLD | Molad e Konsult - Send us a message')\n    useDocTitle('SpeakTranscribe | Upload your audio file')\n    const [errors, setErrors] = useState([])\n    const [audio_file, setFile] = useState(null)\n\n    const clearErrors = () => {\n        setErrors([])\n    }\n\n    const clearInput = () => {\n        setFile(null)\n    }\n\n    const sendFile = (e) => {\n        const cookies = new Cookies();\n        const id_token = cookies.get('id_token');\n        const email = cookies.get('email');\n        const timestamp = new Date().getTime();\n\n        const UPLOAD_AUDIO_TO_S3_API=\"https://wpfyc71o76.execute-api.us-west-2.amazonaws.com/dev/\";\n        const BUCKET_NAME=\"cs690-transcribe/\";\n\n        if(!id_token) {\n            // pop up a window show message\n            const confirmation = window.confirm(\"You should log in. Press OK to go to the login page.\");\n\n            // Redirect to login page\n            if (confirmation) {\n                window.location.href = \"https://xwang.auth.us-west-2.amazoncognito.com/login?client_id=24r2m807jokm1ugg04234bgv09&response_type=token&scope=email+openid+phone&redirect_uri=https%3A%2F%2Fxwang.engineer\";\n            }\n        }\n\n        e.preventDefault();\n        document.getElementById('submitBtn').disabled = true;\n        document.getElementById('submitBtn').innerHTML = 'Loading...';\n\n        const filename = audio_file.name;\n        const fileExtension = filename.split('.').pop().toLowerCase();\n        \n        let content_type = 'audio/';\n        // .AMR, .FLAC, .M4A, .MP3, .MP4, .OGG, .WAV\n        if (fileExtension in ['ogg', 'mp4']) {\n            content_type = 'video/';\n        }\n        content_type += fileExtension;\n\n        axios({\n            method: \"put\",\n            url: UPLOAD_AUDIO_TO_S3_API + BUCKET_NAME + email + \"-\" + timestamp + \".\" + fileExtension,\n            // url: \"https://wpfyc71o76.execute-api.us-west-2.amazonaws.com/dev/cs690-transcribe/file1.m4a\",\n            data: audio_file,\n            headers: {\n                'Content-Type':  content_type,\n                'Authorization': id_token\n            }\n        })\n        .then(function (response) {\n            document.getElementById('submitBtn').disabled = false;\n            document.getElementById('submitBtn').innerHTML = 'send message';\n            clearInput()\n            //handle success\n            Notiflix.Report.success(\n                'Success',\n                response.data.message,\n                'Okay',\n            );\n        })\n        .catch(function (error) {\n            document.getElementById('submitBtn').disabled = false;\n            document.getElementById('submitBtn').innerHTML = 'send message';\n            //handle error\n            const { response } = error;\n            if(response.status === 500) {\n                Notiflix.Report.failure(\n                    'An error occurred',\n                    response.data.message,\n                    'Okay',\n                );\n            }\n            if(response.data.errors !== null) {\n                setErrors(response.data.errors)\n            }\n            \n        });\n    }\n    return (\n        <>\n            <div>\n                <NavBar />\n            </div>\n            <div className=\"flex justify-center items-center mt-8 w-full bg-white py-12 lg:py-24 bg-gray-200\">\n                <div className=\"container mx-auto my-8 px-4 lg:px-20\" data-aos=\"zoom-in\">\n\n                <form onSubmit={sendFile}>\n\n                    <div className=\"w-full bg-white p-8 my-4 md:px-12 lg:w-9/12 lg:pl-20 lg:pr-40 mr-auto rounded-2xl shadow-2xl\">\n                        <div className=\"flex\">\n                            <h1 className=\"font-bold text-center lg:text-left text-blue-900 uppercase text-4xl\">UPLOAD YOUR AUDIO</h1>\n                        </div>\n                        <div className=\"my-4\">\n                                <input\n                                    name=\"audio_file\" \n                                    className=\"w-full bg-gray-100 text-gray-900 mt-2 p-3 rounded-lg focus:outline-none focus:shadow-outline\"\n                                    type=\"file\" \n                                    placeholder=\"Audio File*\"\n                                    accept=\".AMR, .FLAC, .M4A, .MP3, .MP4, .OGG, .WAV\"\n                                    onChange={(e)=> setFile(e.target.files[0])}\n                                    onKeyUp={clearErrors}\n                                />\n                                {errors && \n                                    <p className=\"text-red-500 text-sm\">{errors.audio_file}</p>\n                                }\n                        </div>\n\n                        <div className=\"my-2 w-1/2 lg:w-2/4\">\n                            <button type=\"submit\" id=\"submitBtn\" className=\"uppercase text-sm font-bold tracking-wide bg-gray-500 hover:bg-blue-900 text-gray-100 p-3 rounded-lg w-full \n                                    focus:outline-none focus:shadow-outline\">\n                                Send File\n                            </button>\n                        </div>\n                </div>\n                </form>\n                        \n                </div>\n            </div>\n            <Footer />\n        </>\n\n\n    )\n}\n\nexport default UploadAudio;"]},"metadata":{},"sourceType":"module"}